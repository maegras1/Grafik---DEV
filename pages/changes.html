<div class="changes-header-controls">
    <div class="template-actions">
        <button id="manageTemplatesBtn" class="template-btn" title="Zarządzaj szablonami obsady">
            <i class="fas fa-layer-group"></i> Szablony
        </button>
        <button id="quickPlanningBtn" class="template-btn secondary" title="Szybkie planowanie wielu okresów">
            <i class="fas fa-magic"></i> Szybkie planowanie
        </button>
    </div>
    <div class="year-selector-container">
        <label for="changesYearSelect">Rok:</label>
        <select id="changesYearSelect" class="year-select"></select>
    </div>
</div>

<div id="changesContextMenu" class="context-menu">
    <ul>
        <li id="ctxCopyCell"><i class="fas fa-copy"></i><span>Kopiuj</span></li>
        <li id="ctxPasteCell"><i class="fas fa-paste"></i><span>Wklej</span></li>
        <li id="ctxCopyFromPrevious"><i class="fas fa-arrow-up"></i><span>Kopiuj z poprzedniego okresu</span></li>
        <li id="ctxApplyTemplate"><i class="fas fa-file-import"></i><span>Zastosuj szablon...</span></li>
        <li id="ctxSaveAsTemplate"><i class="fas fa-save"></i><span>Zapisz wiersz jako szablon</span></li>
        <li class="separator"></li>
        <li id="ctxClearCell" class="danger"><i class="fas fa-trash-alt"></i><span>Wyczyść</span></li>
    </ul>
</div>

<table id="changesTable" class="changes-table">
    <thead>
        <tr id="changesHeaderRow"></tr>
    </thead>
    <tbody id="changesTableBody"></tbody>
</table>

<!-- Modal wyboru pracownika -->
<div id="employeeSelectionModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <h2 class="modal-title">Wybierz pracowników</h2>
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="employeeSearchInput" class="search-input" placeholder="Szukaj pracownika..." />
        </div>
        <div id="employeeList" class="modal-body employee-grid">
            <!-- Lista pracowników zostanie wygenerowana dynamicznie w dwóch kolumnach -->
        </div>
        <div class="modal-actions">
            <button id="saveEmployeeSelection" class="action-btn confirm-btn">Zapisz</button>
            <button id="cancelEmployeeSelection" class="action-btn cancel-btn">Anuluj</button>
        </div>
    </div>
</div>

<!-- Modal zarządzania szablonami -->
<div id="templateModal" class="modal-overlay" style="display: none">
    <div class="modal-content template-modal">
        <h2 class="modal-title"><i class="fas fa-layer-group"></i> Szablony obsady</h2>
        <div class="template-modal-body">
            <div class="template-list-section">
                <h3>Zapisane szablony</h3>
                <div id="templateList" class="template-list">
                    <!-- Szablony zostaną wygenerowane dynamicznie -->
                </div>
            </div>
            <div class="template-preview-section">
                <h3>Podgląd szablonu</h3>
                <div id="templatePreview" class="template-preview">
                    <p class="template-placeholder">Wybierz szablon, aby zobaczyć podgląd</p>
                </div>
            </div>
        </div>
        <div class="modal-actions">
            <button id="closeTemplateModal" class="action-btn cancel-btn">Zamknij</button>
        </div>
    </div>
</div>

<!-- Modal zapisu nowego szablonu -->
<div id="saveTemplateModal" class="modal-overlay" style="display: none">
    <div class="modal-content small-modal">
        <h2 class="modal-title"><i class="fas fa-save"></i> Zapisz jako szablon</h2>
        <div class="form-group">
            <label for="templateNameInput">Nazwa szablonu:</label>
            <input type="text" id="templateNameInput" class="form-input" placeholder="np. Standardowa obsada" />
        </div>
        <div class="modal-actions">
            <button id="confirmSaveTemplate" class="action-btn confirm-btn">Zapisz</button>
            <button id="cancelSaveTemplate" class="action-btn cancel-btn">Anuluj</button>
        </div>
    </div>
</div>

<!-- Modal wyboru szablonu do zastosowania -->
<div id="applyTemplateModal" class="modal-overlay" style="display: none">
    <div class="modal-content small-modal">
        <h2 class="modal-title"><i class="fas fa-file-import"></i> Zastosuj szablon</h2>
        <div class="form-group">
            <label for="templateSelect">Wybierz szablon:</label>
            <select id="templateSelect" class="form-select">
                <option value="">-- Wybierz szablon --</option>
            </select>
        </div>
        <div id="applyTemplatePreview" class="template-apply-preview"></div>
        <div class="modal-actions">
            <button id="confirmApplyTemplate" class="action-btn confirm-btn">Zastosuj</button>
            <button id="cancelApplyTemplate" class="action-btn cancel-btn">Anuluj</button>
        </div>
    </div>
</div>

<!-- Modal stosowania szablonu do wielu okresów -->
<div id="multiPeriodTemplateModal" class="modal-overlay" style="display: none">
    <div class="modal-content multi-period-modal">
        <h2 class="modal-title"><i class="fas fa-layer-group"></i> Szybkie planowanie</h2>
        <p class="modal-subtitle">Zastosuj szablon do wielu okresów jednocześnie</p>

        <div class="multi-period-form">
            <div class="form-group">
                <label for="multiTemplateSelect">Szablon:</label>
                <select id="multiTemplateSelect" class="form-select">
                    <option value="">-- Wybierz szablon --</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group half">
                    <label for="periodFromSelect">Od okresu:</label>
                    <select id="periodFromSelect" class="form-select">
                        <option value="">-- Wybierz --</option>
                    </select>
                </div>
                <div class="form-group half">
                    <label for="periodToSelect">Do okresu:</label>
                    <select id="periodToSelect" class="form-select">
                        <option value="">-- Wybierz --</option>
                    </select>
                </div>
            </div>

            <div class="selected-periods-info">
                <span class="periods-count" id="selectedPeriodsCount">Wybrano: 0 okresów</span>
            </div>

            <div id="multiTemplatePreview" class="template-apply-preview"></div>
        </div>

        <div class="modal-actions">
            <button id="confirmMultiPeriodTemplate" class="action-btn confirm-btn">
                <i class="fas fa-magic"></i> Zastosuj do wszystkich
            </button>
            <button id="cancelMultiPeriodTemplate" class="action-btn cancel-btn">Anuluj</button>
        </div>
    </div>
</div>